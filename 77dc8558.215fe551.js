(window.webpackJsonp=window.webpackJsonp||[]).push([[27],{138:function(e,t,n){"use strict";n.d(t,"a",(function(){return u})),n.d(t,"b",(function(){return s}));var a=n(0),o=n.n(a);function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function b(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?b(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):b(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,o=function(e,t){if(null==e)return{};var n,a,o={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var c=o.a.createContext({}),i=function(e){var t=o.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):p(p({},t),e)),n},u=function(e){var t=i(e.components);return o.a.createElement(c.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return o.a.createElement(o.a.Fragment,{},t)}},j=o.a.forwardRef((function(e,t){var n=e.components,a=e.mdxType,l=e.originalType,b=e.parentName,c=r(e,["components","mdxType","originalType","parentName"]),u=i(n),j=a,s=u["".concat(b,".").concat(j)]||u[j]||m[j]||l;return n?o.a.createElement(s,p(p({ref:t},c),{},{components:n})):o.a.createElement(s,p({ref:t},c))}));function s(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var l=n.length,b=new Array(l);b[0]=j;var p={};for(var r in t)hasOwnProperty.call(t,r)&&(p[r]=t[r]);p.originalType=e,p.mdxType="string"==typeof e?e:a,b[1]=p;for(var c=2;c<l;c++)b[c]=n[c];return o.a.createElement.apply(null,b)}return o.a.createElement.apply(null,n)}j.displayName="MDXCreateElement"},245:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/multitask-1c286c60f3d7cfcb35ac1ed866b8e08e.png"},246:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/thread1-b2cd4cc27f2bc8abce0f52a8155ad07d.png"},247:function(e,t,n){"use strict";n.r(t),t.default=n.p+"assets/images/stavy-5aae6cf704d1ceeeac38e6e0e22445d1.png"},95:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return b})),n.d(t,"metadata",(function(){return p})),n.d(t,"toc",(function(){return r})),n.d(t,"default",(function(){return i}));var a=n(3),o=n(7),l=(n(0),n(138)),b={author:["Daniel Hampl"],subject:"OSY"},p={unversionedId:"bi-spol-16/bi-spol-16",id:"bi-spol-16/bi-spol-16",isDocsHomePage:!1,title:"bi-spol-16",description:"Procesy a vl\xe1kna",source:"@site/topics/bi-spol-16/bi-spol-16.mdx",slug:"/bi-spol-16/bi-spol-16",permalink:"/szz-bootcamp/topics/bi-spol-16/bi-spol-16",version:"current",lastUpdatedBy:"Tomas Vosicky",sidebar:"someSidebar",previous:{title:"bi-spol-15",permalink:"/szz-bootcamp/topics/bi-spol-15/bi-spol-15"},next:{title:"bi-spol-18",permalink:"/szz-bootcamp/topics/bi-spol-18/bi-spol-18"}},r=[{value:"Procesy",id:"procesy",children:[]},{value:"Vl\xe1kna",id:"vl\xe1kna",children:[]},{value:"Z\xe1kaz p\u0159eru\u0161en\xed (DI)",id:"z\xe1kaz-p\u0159eru\u0161en\xed-di",children:[{value:"Nev\xfdhody",id:"nev\xfdhody",children:[]}]},{value:"Aktivn\xed \u010dek\xe1n\xed vs blokov\xe1n\xed",id:"aktivn\xed-\u010dek\xe1n\xed-vs-blokov\xe1n\xed",children:[{value:"Aktivn\xed \u010dek\xe1n\xed",id:"aktivn\xed-\u010dek\xe1n\xed",children:[]},{value:"Blokov\xe1n\xed",id:"blokov\xe1n\xed",children:[]}]},{value:"Sd\xedlen\xe1 prom\u011bnn\xe1",id:"sd\xedlen\xe1-prom\u011bnn\xe1",children:[]},{value:"Instrukce TSL",id:"instrukce-tsl",children:[]},{value:"Instrukce XCHG",id:"instrukce-xchg",children:[]},{value:"Probl\xe9my",id:"probl\xe9my",children:[{value:"Bez pou\u017eit\xed synchronizace (\u010dasov\u011b z\xe1visl\xe9 chyby)",id:"bez-pou\u017eit\xed-synchronizace-\u010dasov\u011b-z\xe1visl\xe9-chyby",children:[]},{value:"P\u0159i pou\u017eit\xed synchronizace",id:"p\u0159i-pou\u017eit\xed-synchronizace",children:[]},{value:"Inverzn\xed prioritn\xed probl\xe9m",id:"inverzn\xed-prioritn\xed-probl\xe9m",children:[]},{value:"Synchronizace pomoc\xed blokov\xe1n\xed",id:"synchronizace-pomoc\xed-blokov\xe1n\xed",children:[]}]},{value:"Typy synchronizace",id:"typy-synchronizace",children:[]},{value:"Adresov\xe1n\xed",id:"adresov\xe1n\xed",children:[]},{value:"Sleep &amp; Wakeup",id:"sleep--wakeup",children:[{value:"wait()",id:"wait",children:[]},{value:"wakeup(thread)",id:"wakeupthread",children:[]}]},{value:"Condition variable",id:"condition-variable",children:[{value:"cond_wait(&amp;var, &amp;mutex)",id:"cond_waitvar-mutex",children:[]},{value:"cond_signal(&amp;var)",id:"cond_signalvar",children:[]}]},{value:"Semafor",id:"semafor",children:[]},{value:"Bari\xe9ry",id:"bari\xe9ry",children:[]},{value:"Zp\u016fsoby \u0159e\u0161en\xed uv\xe1znut",id:"zp\u016fsoby-\u0159e\u0161en\xed-uv\xe1znut",children:[{value:"P\u0161tros\xed algoritmus",id:"p\u0161tros\xed-algoritmus",children:[]},{value:"Detekce a zotaven\xed",id:"detekce-a-zotaven\xed",children:[]},{value:"Pe\u010dliv\xe1 alokace prost\u0159edk\u016f",id:"pe\u010dliv\xe1-alokace-prost\u0159edk\u016f",children:[]},{value:"Prevence pomoc\xed nespln\u011bn\xed aspo\u0148 jedn\xe9 z Coffmanov\xfdch podm\xednek",id:"prevence-pomoc\xed-nespln\u011bn\xed-aspo\u0148-jedn\xe9-z-coffmanov\xfdch-podm\xednek",children:[]}]},{value:"Ve\u010de\u0159\xedc\xed filosofov\xe9",id:"ve\u010de\u0159\xedc\xed-filosofov\xe9",children:[]},{value:"\u010cten\xe1\u0159i - p\xedsa\u0159i",id:"\u010dten\xe1\u0159i---p\xedsa\u0159i",children:[]},{value:"Producent - konzument",id:"producent---konzument",children:[]}],c={toc:r};function i(e){var t=e.components,b=Object(o.a)(e,["components"]);return Object(l.b)("wrapper",Object(a.a)({},c,b,{components:t,mdxType:"MDXLayout"}),Object(l.b)("h1",{id:"procesy-a-vl\xe1kna"},"Procesy a vl\xe1kna"),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"Program")," je posloupnost instrukc\xed definuj\xedc\xedch chov\xe1n\xed procesu."),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"Proces")," je instance spu\u0161t\u011bn\xe9ho programu, kter\xe1 slou\u017e\xed k alokov\xe1n\xed\nprost\u0159edk\u016f (adresov\xfd prostor, otev\u0159en\xe9 soubory, ",".",".. ). Informace o\ntomto procesu (ID, identita, informace o rodi\u010di a potomc\xedch,",".","..) jsou\nn\xe1sledn\u011b ulo\u017eeny v j\xe1dru."),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"Vl\xe1kno")," je \u010d\xe1st v\xfdpo\u010dtu, kter\xe9 je p\u0159id\u011blov\xe1n procesor (j\xe1dro CPU).\nJ\xe1dro alokuje pro ka\u017ed\xe9 vl\xe1kno z\xe1sobn\xedk (pro historii v\xfdpo\u010dtu a lok\xe1ln\xed\nprom\u011bnn\xe9) a udr\u017euje aktu\xe1ln\xed hodnoty registr\u016f (pro op\u011btovn\xe9 spu\u0161t\u011bn\xed)"),Object(l.b)("h2",{id:"procesy"},"Procesy"),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"Vytvo\u0159en\xed")),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"OS inicializuje v j\xe1d\u0159e datov\xe9 struktury spojen\xe9 s nov\xfdm procesem.")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"OS nahraje k\xf3d a data programu z disku do pam\u011bti a vytvo\u0159\xed pr\xe1zdn\xfd\nsyst\xe9mov\xfd z\xe1sobn\xedk pro main vl\xe1kno."))),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"Klonovan\xed")),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"OS zastav\xed aktu\xe1ln\xed proces a ulo\u017e\xed jeho stav.")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"OS inicializuje v j\xe1d\u0159e datov\xe9 struktury spojen\xe9 s nov\xfdm procesem.")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"OS ud\u011bl\xe1 kopii aktu\xe1ln\xedho k\xf3du, dat, z\xe1sobn\xedku, stavu procesu,",".",".."))),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"fork()")),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Vytvo\u0159\xed nov\xfd proces, kter\xfd je kopi\xed procesu, z kter\xe9ho byla tato\nfunkce zavol\xe1na.")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"V rodi\u010dovsk\xe9m procesu vrac\xed funkce PID potomka")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"V potomkovi vrac\xed funkce 0")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"K\xf3dov\xfd segment sd\xedl\xed potomek s rodi\u010dem.")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Datov\xfd a z\xe1sobn\xedkov\xfd segment vznikaj\xed kopi\xed dat a z\xe1sobn\xedku rodi\u010de."))),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"execve(char ","*","filename,",".","..)")),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"V procesu, ze kter\xe9ho je funkce vol\xe1na, spust\xed nov\xfd program.")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Obsah p\u016fvodn\xedho procesu je p\u0159eps\xe1n nov\xfdm programem.")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Atributy procesu se nem\u011bn\xed (PID, PPID, ",".","..)."))),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"wait(int ","*","status)")),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Umo\u017e\u0148uje v rodi\u010dovsk\xe9m procesu po\u010dkat na dokon\u010den\xed potomka.")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Funkce zablokuje rodi\u010dovsk\xfd proces, ve kter\xe9m je zavol\xe1na, dokud se\njeden potomek neukon\u010d\xed."))),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"Ukon\u010den\xed")),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Proces se pokus\xed p\u0159edat n\xe1vratov\xfd k\xf3d rodi\u010di")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Ukon\u010den\xed v\u0161ech vl\xe1ken, kter\xe1 existuj\xed v r\xe1mci procesu")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Uvoln\u011bn\xed aresov\xe9ho prostoru procesu a jeho datov\xfdch struktu"))),Object(l.b)("h2",{id:"vl\xe1kna"},"Vl\xe1kna"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Jsou jednotky pl\xe1novan\xe9 pro spu\u0161t\u011bn\xed na CPU")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Ka\u017ed\xe9 vl\xe1kno m\xe1 vlastn\xed:"),Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Hodnotu \u010d\xedta\u010de instrukc\xed")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Hodnotu CPU registr\u016f")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Z\xe1sobn\xedk")))),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Ostatn\xed prost\u0159edky jsou sd\xedlen\xe9")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Vl\xe1kna nejsou nez\xe1visl\xe1 jako procesy")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Vl\xe1kna sd\xedl\xed stejn\xfd adresov\xfd prostor, stejn\xe9 soubory, potomky a\nreakce na sign\xe1ly"))),Object(l.b)("p",null,Object(l.b)("img",{alt:"image",src:n(245).default}),'{width=".8',"\\",'textwidth"}'),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"Vytvo\u0159en\xed")),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"pthread_create() v POSIXu")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"CreateThread() v MS Win"))),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"Ukon\u010den\xed")),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"pthread_exit() POSIX")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"ExitThread() MS Win"))),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"P\u0159ep\xedn\xe1n\xed kontextu")),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Rozd\u011blen\xed vl\xe1ken jednotliv\xfdch proces\u016f mezi jednotliv\xe1 j\xe1dra")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Vl\xe1kno m\xe1 svoj\xed dobu, po kterou m\u016f\u017ee b\u011b\u017eet na dan\xe9m j\xe1d\u0159e, pak je\npreru\u0161eno a je d\xe1n \u010das jin\xe9mu vl\xe1knu"))),Object(l.b)("p",null,Object(l.b)("img",{alt:"image",src:n(246).default}),'{width=".8',"\\",'textwidth"}'),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"Stavy vl\xe1ken")),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Idle: vznik nov\xe9ho vl\xe1kna")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Ready: vl\xe1kno \u010dek\xe1 a\u017e mu bude p\u0159i\u010feleno j\xe1dro CPU")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Running: vl\xe1kno je zpracov\xe1v\xe1no j\xe1drem CPU")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Blocked: vl\xe1kno \u010dek\xe1 na ud\xe1lost (dokon\u010den\xed I/O operace, p\u0159\xedchod\nsign\xe1lu,",".","..)")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Zombie: vl\xe1kno je ukon\u010dov\xe1no, ale zat\xedm je\u0161t\u011b nebylo v\u0161e dokon\u010deno")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Free: vl\xe1kno bylo kompletne zru\u0161eno (pouze teoretick\xfd stav)"))),Object(l.b)("p",null,Object(l.b)("img",{alt:"image",src:n(247).default}),'{width=".8',"\\",'textwidth"}'),Object(l.b)("h1",{id:"synchronizace"},"Synchronizace"),Object(l.b)("h2",{id:"z\xe1kaz-p\u0159eru\u0161en\xed-di"},"Z\xe1kaz p\u0159eru\u0161en\xed (DI)"),Object(l.b)("p",null,"CPU je p\u0159id\u011blov\xe1no postupn\u011b jednotliv\xfdm vl\xe1kn\u016fm za pomoci p\u0159eru\u0161en\xed od\n\u010dasova\u010de nebo jin\xe9ho p\u0159eru\u0161en\xed. Vl\xe1kno zak\xe1\u017ee v\u0161echna p\u0159eru\u0161en\xed p\u0159ed\nvstupem do kritick\xe9 sekce a op\u011bt je povol\xed a\u017e po jej\xedm opu\u0161t\u011bn\xed."),Object(l.b)("h3",{id:"nev\xfdhody"},"Nev\xfdhody"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"DI od jednoho u\u017eivatele blokuje i ostatn\xed")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"V multi-CPU m\xe1 efekt pouze na aktu\xe1ln\xed CPU")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Zpomal\xed reakce na p\u0159eru\u0161en\xed")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Mo\u017enost blokovat cel\xe9 CPU p\u0159i chybn\xe9 implementaci")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Nehod\xed se pro b\u011b\u017en\xe1 u\u017eivatelsk\xe1 vl\xe1kna"))),Object(l.b)("h2",{id:"aktivn\xed-\u010dek\xe1n\xed-vs-blokov\xe1n\xed"},"Aktivn\xed \u010dek\xe1n\xed vs blokov\xe1n\xed"),Object(l.b)("p",null,"Pouze jedno vl\xe1kno m\u016f\u017ee do kritick\xe9 sekce, ostatn\xed maj\xed sm\u016flu"),Object(l.b)("h3",{id:"aktivn\xed-\u010dek\xe1n\xed"},"Aktivn\xed \u010dek\xe1n\xed"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Sd\xedlen\xe1 prom\u011bnn\xe1 indikuje obsazenost")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Vl\xe1kna ve smy\u010dce testuj\xed tuto hodnotu a \u010dekaj\xed a\u017e budou moci\npostoupit")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Pokud se dlouho \u010dek\xe1 na vstup do kritick\xe9 sekce, doch\xe1z\xed k pl\xfdtv\xe1n\xed\n\u010dasem procesoru"))),Object(l.b)("h3",{id:"blokov\xe1n\xed"},"Blokov\xe1n\xed"),Object(l.b)("p",null,"Vl\xe1kno provede syst\xe9mov\xe9 vol\xe1n\xed, kter\xe9 ho zablokuje do okam\u017eiku ne\u017e se\nsekce uvoln\xed"),Object(l.b)("h2",{id:"sd\xedlen\xe1-prom\u011bnn\xe1"},"Sd\xedlen\xe1 prom\u011bnn\xe1"),Object(l.b)("p",null,"Vz\xe1jemn\xe9 vylou\u010den\xed nastaven\xedm sd\xedlen\xe9 prom\u011bnn\xe9 p\u0159i vstupu do sekce"),Object(l.b)("h2",{id:"instrukce-tsl"},"Instrukce TSL"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Test and Set Lock (TSL) - instrukce na\u010dte obsah slova do registru a\nnastav\xed obsah slova na nenulovou hodnotu")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"CPU prov\xe1d\u011bj\xedc\xed TSL lockne pam\u011b\u0165ovou sb\u011brnici dokud se TSL nedokon\u010d\xed")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"TSL je atomick\xe1 instrukce")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"TSL lze pou\u017e\xedt u multi-cpu se sd\xedlenou pam\u011bt\xed"))),Object(l.b)("h2",{id:"instrukce-xchg"},"Instrukce XCHG"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Alternativa k TSL")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Exchange instrukce (XCHG) atomicky prohod\xed obsah slova na dan\xe9\nadrese v pam\u011bti a registru"))),Object(l.b)("h2",{id:"probl\xe9my"},"Probl\xe9my"),Object(l.b)("h3",{id:"bez-pou\u017eit\xed-synchronizace-\u010dasov\u011b-z\xe1visl\xe9-chyby"},"Bez pou\u017eit\xed synchronizace (\u010dasov\u011b z\xe1visl\xe9 chyby)"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Dva a v\xedce proces\u016f \u010di vl\xe1ken pou\u017e\xedv\xe1 spole\u010dn\xe9 prost\u0159edky (sd\xedlen\xe1\npam\u011b\u0165, soubor, prom\u011bnn\xe1)")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"V\xfdsledek je z\xe1visl\xfd na p\u0159ep\xedn\xe1n\xed kontextu")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Tyto chyby jsou velmi \u0161patn\u011b detekovateln\xe9"))),Object(l.b)("h3",{id:"p\u0159i-pou\u017eit\xed-synchronizace"},"P\u0159i pou\u017eit\xed synchronizace"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Deadlock = situace kdy se v\xedce vl\xe1ken \u010dek\xe1 na ud\xe1lost, kterou m\u016f\u017ee\nvyvolat pouze jedno z \u010dekaj\xedc\xedch vl\xe1ken")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Livelock = situace, kdy n\u011bkolik vl\xe1ken vykon\xe1v\xe1 neu\u017eite\u010dnou \u010dinnost\n(m\u011bn\xed sv\u016fj stav), ale nemohou postoupit k vykon\xe1v\xe1n\xed usefull pr\xe1ce")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Hladov\u011bn\xed = situace, kdy ready vl\xe1kno je p\u0159edb\xedh\xe1no a nedostane se k\nprost\u0159edk\u016fm"))),Object(l.b)("h3",{id:"inverzn\xed-prioritn\xed-probl\xe9m"},"Inverzn\xed prioritn\xed probl\xe9m"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Vl\xe1kno A m\xe1 ni\u017e\u0161\xed prio. a je v kritick\xe9 sekci")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Vl\xe1kno B m\xe1 vy\u0161\u0161\xed prio. a \u010dek\xe1 pomoc\xed aktivn\xedho \u010dek\xe1n\xed")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"OS pou\u017e\xedv\xe1 prioritn\xed pl\xe1nov\xe1n\xed, m\xe1 1 j\xe1dro na 1 CPU")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Potom m\u016f\u017ee nastat, je-li priorita fixn\xed, uv\xe1znut\xed"))),Object(l.b)("h3",{id:"synchronizace-pomoc\xed-blokov\xe1n\xed"},"Synchronizace pomoc\xed blokov\xe1n\xed"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Ve v\u011bt\u0161ina p\u0159\xedpad\u016f je blokov\xe1n\xed lep\u0161\xed ne\u017e aktivn\xed \u010dek\xe1n\xed \u010di z\xe1kaz\np\u0159eru\u0161en\xed")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Vl\xe1kno je zablokov\xe1no, pokud chce vstoupit do ji\u017e zablokovan\xe9\nkritick\xe9 sekce, je p\u0159esunuto na \u010dekac\xed frontu")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Tyto operace ji\u017e na \xfarovni j\xe1dra OS"))),Object(l.b)("h2",{id:"typy-synchronizace"},"Typy synchronizace"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Blokuj\xedc\xed send i receive - rendevous")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Neblokuj\xedc\xed send a blokuj\xedc\xed receive")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Neblokuj\xedc\xed send i receive + test p\u0159\xedchoz\xedch zpr\xe1v"))),Object(l.b)("h2",{id:"adresov\xe1n\xed"},"Adresov\xe1n\xed"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"P\u0159\xedm\xe9 - Zpr\xe1va je ulo\u017eena p\u0159\xedmo do prostoru p\u0159\xedjemce")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Nep\u0159\xedm\xe9 - Zpr\xe1va je ulo\u017eena do sd\xedlen\xe9ho prostoru (mailbox)"))),Object(l.b)("h1",{id:"p\u0159id\u011blov\xe1n\xed-prost\u0159edk\u016f"},"P\u0159id\u011blov\xe1n\xed prost\u0159edk\u016f"),Object(l.b)("h2",{id:"sleep--wakeup"},"Sleep & Wakeup"),Object(l.b)("h3",{id:"wait"},"wait()"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Syst\xe9mov\xe9 vol\xe1n\xed")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Zablokuje vl\xe1kno, kter\xe9 ho zavolalo")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Zak\xe1\u017ee alokaci CPU pro toto vl\xe1kno a p\u0159esune jej do fronty, kde \u010dek\xe1\nna probuzen\xed"))),Object(l.b)("h3",{id:"wakeupthread"},"wakeup(thread)"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Probud\xed vl\xe1kno uspan\xe9 pomoc\xed wait()")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Odstran\xed vl\xe1kno z \u010dekac\xed fronty")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Povol\xed alokaci CPU")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Waiting bit"),Object(l.b)("ul",{parentName:"li"},Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Wakeup vol\xe1n\xed na neuspan\xe9 vl\xe1kno - bit je nastaven")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Usp\xe1n\xed vl\xe1kna s ji\u017e nastaven\xfdm bitem - vl\xe1kno nen\xed usp\xe1no, ale\nbit je pouze resetov\xe1n"))))),Object(l.b)("h2",{id:"condition-variable"},"Condition variable"),Object(l.b)("h3",{id:"cond_waitvar-mutex"},"cond_wait(&var, &mutex)"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Mutex zam\u010den a dan\xe9m vl\xe1knu")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Po zavol\xe1n\xed je mutex odem\u010den a vl\xe1kno usp\xe1no")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Po probuzen\xed je mutex znovu uzam\u010den"))),Object(l.b)("h3",{id:"cond_signalvar"},"cond_signal(&var)"),Object(l.b)("p",null,"Odblokuje alespo\u0148 jedno z uspan\xfdch vl\xe1ken"),Object(l.b)("h2",{id:"semafor"},"Semafor"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Obsahuje \u010d\xedta\u010d a frontu \u010dekaj\xedc\xedch proces\u016f")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Instrukce jsou prov\xe1d\u011bny atomicky (nelze je p\u0159eru\u0161it)")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},Object(l.b)("strong",{parentName:"p"},"Init()")," Nastaven\xed \u010d\xedta\u010de na zadan\xe9 \u010d\xedslo a vypr\xe1zdn\xed se fronta")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},Object(l.b)("strong",{parentName:"p"},"Down()")," Pokud je \u010d\xedta\u010d ",">"," 0, sn\xed\u017e\xed se o jedna. V opa\u010dn\xe9m p\u0159\xedpad\u011b\nje vl\xe1kno ulo\u017eeno do fronty.")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},Object(l.b)("strong",{parentName:"p"},"Up()")," Pokud je fronta nepr\xe1zdn\xe1, probud\xed se jedno z \u010dekaj\xedc\xedch\nvl\xe1ken. V opa\u010dn\xe9m p\u0159\xedpad\u011b se nav\xfd\u0161\xed \u010d\xedta\u010d o jedna.")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},Object(l.b)("strong",{parentName:"p"},"Monitory")," Do bloku je vpu\u0161t\u011bno v\u017edy jen jedno vl\xe1kno O vylou\u010den\xed\nv r\xe1mci bloku se star\xe1 p\u0159eklada\u010d nikoli program\xe1tor")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},Object(l.b)("strong",{parentName:"p"},"wait(c)")," Pozastav\xed vl\xe1kno na podm\xedn\u011bn\xe9 prom\u011bnn\xe9 c")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},Object(l.b)("strong",{parentName:"p"},"signal(c)")," Probud\xed jedno z pozastaven\xfdch vl\xe1ken"))),Object(l.b)("h2",{id:"bari\xe9ry"},"Bari\xe9ry"),Object(l.b)("p",null,"Propou\u0161t\xed minim\xe1ln\xed po\u010det vl\xe1ken. Kdy\u017e vl\xe1kna p\u0159ijdou k bari\xe9\u0159e, tak\n\u010dekaj\xed, dokud jich nen\xed minim\xe1ln\xed po\u010det, a a\u017e pot\xe9 jsou pu\u0161t\u011bny d\xe1l"),Object(l.b)("h1",{id:"coffmanovy-podm\xednky"},"Coffmanovy podm\xednky"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Uv\xe1znut\xed nastane pouze pokud jsou spln\u011bny n\xe1sleduj\xedc\xed podm\xednky."),Object(l.b)("ol",{parentName:"li"},Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},Object(l.b)("strong",{parentName:"p"},"Vz\xe1jemn\xe9 vylou\u010den\xed:")," ka\u017ed\xfd prost\u0159edek je bu\u010f p\u0159id\u011blen pr\xe1v\u011b\njednomu vl\xe1knu a nebo je voln\xfd (prost\u0159edek nem\u016f\u017ee b\xfdt sd\xedlen\nv\xedce vl\xe1kny).")),Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},Object(l.b)("strong",{parentName:"p"},"Podm\xednka neodn\xedmatelnosti:")," prost\u0159edek, kter\xfd byl ji\u017e\np\u0159id\u011blen n\u011bjak\xe9mu vl\xe1knu, nem\u016f\u017ee mu b\xfdt n\xe1sil\xedm odebr\xe1n (mus\xed\nb\xfdt dobrovoln\u011b uvoln\u011bn dan\xfdm vl\xe1knem).")),Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},Object(l.b)("strong",{parentName:"p"},'Podm\xednka \\"dr\u017e a \u010dekej\\":')," vl\xe1kno, kter\xe9 m\xe1 ji\u017e p\u0159ideleny\nn\u011bjak\xe9 prost\u0159edky, m\u016f\u017ee \u017e\xe1dat o dal\u0161\xed prost\u0159edky (vl\xe1kno m\u016f\u017ee\n\u017e\xe1dat o prost\u0159edky postupn\u011b).")),Object(l.b)("li",{parentName:"ol"},Object(l.b)("p",{parentName:"li"},Object(l.b)("strong",{parentName:"p"},"Podm\xednka kruhov\xe9ho \u010dek\xe1n\xed:")," mus\xed existovat smy\u010dka dvou nebo\nv\xedce vl\xe1ken, ve kter\xe9 ka\u017ed\xe9 vl\xe1kno \u010dek\xe1 na prost\u0159edek p\u0159idelen\xfd\ndal\u0161\xedmu vl\xe1knu ve smy\u010dce.")))),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Prvn\xed t\u0159i podm\xednky jsou nutn\xe9 ale ne dosta\u010duj\xedc\xed ",Object(l.b)("span",Object(a.a)({parentName:"p"},{className:"math math-inline"}),Object(l.b)("span",Object(a.a)({parentName:"span"},{className:"katex"}),Object(l.b)("span",Object(a.a)({parentName:"span"},{className:"katex-mathml"}),Object(l.b)("math",Object(a.a)({parentName:"span"},{xmlns:"http://www.w3.org/1998/Math/MathML"}),Object(l.b)("semantics",{parentName:"math"},Object(l.b)("mrow",{parentName:"semantics"},Object(l.b)("mtext",{parentName:"mrow"},"\u2005\u200a"),Object(l.b)("mo",{parentName:"mrow"},"\u27f9"),Object(l.b)("mtext",{parentName:"mrow"},"\u2005\u200a")),Object(l.b)("annotation",Object(a.a)({parentName:"semantics"},{encoding:"application/x-tex"}),"\\implies")))),Object(l.b)("span",Object(a.a)({parentName:"span"},{className:"katex-html","aria-hidden":"true"}),Object(l.b)("span",Object(a.a)({parentName:"span"},{className:"base"}),Object(l.b)("span",Object(a.a)({parentName:"span"},{className:"strut",style:{height:"0.549em",verticalAlign:"-0.024em"}})),Object(l.b)("span",Object(a.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}})),Object(l.b)("span",Object(a.a)({parentName:"span"},{className:"mrel"}),"\u27f9"),Object(l.b)("span",Object(a.a)({parentName:"span"},{className:"mspace",style:{marginRight:"0.2777777777777778em"}}))))))," k\nuv\xe1znut\xed m\u016f\u017ee doj\xedt. Posledn\xed podm\xednka p\u0159edstavuje samotn\xe9 uv\xe1znut\xed.")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Pokud aspon jedna z podm\xednek nen\xed spln\u011bna, nem\u016f\u017ee doj\xedt k uv\xe1znut\xed."))),Object(l.b)("h1",{id:"uv\xe1znut\xed"},"Uv\xe1znut\xed"),Object(l.b)("h2",{id:"zp\u016fsoby-\u0159e\u0161en\xed-uv\xe1znut"},"Zp\u016fsoby \u0159e\u0161en\xed uv\xe1znut"),Object(l.b)("h3",{id:"p\u0161tros\xed-algoritmus"},"P\u0161tros\xed algoritmus"),Object(l.b)("p",null,"\xdapln\xe9 ignorov\xe1n\xed cel\xe9ho probl\xe9mu."),Object(l.b)("h3",{id:"detekce-a-zotaven\xed"},"Detekce a zotaven\xed"),Object(l.b)("p",null,"K uv\xe1znut\xed m\u016f\u017ee doj\xedt, ale pak je detekov\xe1no a odstran\u011bno"),Object(l.b)("p",null,"Zotaven\xed pomoc\xed odebr\xe1n\xed - n\xe1siln\xe9 odebr\xe1n\xed prost\u0159edku"),Object(l.b)("p",null,"Zotaven\xed pomoc\xed n\xe1vratu - p\u0159i detekci uv\xe1znut\xed je proces vr\xe1cen zp\u011bt v\n\u010dase"),Object(l.b)("p",null,"Zotaven\xed pomoc\xed ukon\u010den\xed proces\u016f - ukon\u010den\xed procesu ze smy\u010dky aloka\u010dn\xedho\ngrafu"),Object(l.b)("h3",{id:"pe\u010dliv\xe1-alokace-prost\u0159edk\u016f"},"Pe\u010dliv\xe1 alokace prost\u0159edk\u016f"),Object(l.b)("h3",{id:"prevence-pomoc\xed-nespln\u011bn\xed-aspo\u0148-jedn\xe9-z-coffmanov\xfdch-podm\xednek"},"Prevence pomoc\xed nespln\u011bn\xed aspo\u0148 jedn\xe9 z Coffmanov\xfdch podm\xednek"),Object(l.b)("h1",{id:"p\u0159\xedklady"},"P\u0159\xedklady"),Object(l.b)("h2",{id:"ve\u010de\u0159\xedc\xed-filosofov\xe9"},"Ve\u010de\u0159\xedc\xed filosofov\xe9"),Object(l.b)("p",null,"Model vl\xe1ken, kter\xe9 sout\u011b\u017e\xed o v\xfdlu\u010dn\xfd p\u0159\xedstup k omezen\xe9mu po\u010dtu\nprost\u0159edk\u016f."),Object(l.b)("p",null,"N filozof\u016f sed\xed kolem kulat\xe9ho stolu a ka\u017ed\xfd z nich bu\u010f p\u0159em\xfd\u0161l\xed nebo\nj\xed. K j\xeddlu pot\u0159ebuje sou\u010dasn\u011b levou a pravou vidli\u010dku."),Object(l.b)("p",null,"\u0158e\u0161en\xed:"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Pomoc\xed mutexu")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Ov\u011b\u0159ovani \u017ee m\u016f\u017eeme vz\xedt ob\u011b vidli\u010dky (atomick\xe9)")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Upozorn\u011bn\xed soused\u016f po skon\u010den\xed")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Sousedi blokov\xe1ni mutexem ne\u017e dostanou upozorn\u011bn\xed"))),Object(l.b)("h2",{id:"\u010dten\xe1\u0159i---p\xedsa\u0159i"},"\u010cten\xe1\u0159i - p\xedsa\u0159i"),Object(l.b)("p",null,"Model vl\xe1ken, kter\xe9 p\u0159istupuj\xed do spole\u010dn\xe9 datab\xe1ze."),Object(l.b)("p",null,"V\xedce \u010dten\xe1\u0159\u016f m\u016f\u017ee \u010d\xedst sou\u010dasn\u011b data pokud \u017e\xe1dn\xfd p\xedsa\u0159 nemodifikuje data\nv datab\xe1zi."),Object(l.b)("p",null,"Pouze jeden p\xedsa\u0159 m\u016f\u017ee modifikovat data v datab\xe1zi v jednom okam\u017eiku."),Object(l.b)("p",null,"\u0158e\u0161en\xed:"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Pomoc mutexu a counteru")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Uzav\xedr\xe1n\xed DB p\u0159i psan\xed")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Reader \u010dek\xe1 ne\u017e m\u016f\u017ee \u010d\xedst")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Reader notifikuje writer kdy\u017e u\u017e nikdo ne\u010dte")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Writer \u010dek\xe1 ne\u017e m\u016f\u017ee ps\xe1t")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Writer notifikuje reader kdy\u017e u\u017e nepi\u0161e"))),Object(l.b)("h2",{id:"producent---konzument"},"Producent - konzument"),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"Producent")," produkuje data a vkl\xe1d\xe1 je do sd\xedlen\xe9 fronty s omezenou\nkapacitou"),Object(l.b)("p",null,Object(l.b)("strong",{parentName:"p"},"Konzument")," vyb\xedr\xe1 data ze sd\xedlen\xe9 fronty."),Object(l.b)("p",null,"\u0158e\u0161en\xed:"),Object(l.b)("ul",null,Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"T\u0159i mutexy")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Jeden pro pr\u0159\xedstup do fronty")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Jeden pro stav full (konzument \u010dek\xe1)")),Object(l.b)("li",{parentName:"ul"},Object(l.b)("p",{parentName:"li"},"Jeden pro stav empty (producent \u010dek\xe1)"))))}i.isMDXComponent=!0}}]);